Управление кластером
--------------------

Права доступа
^^^^^^^^^^^^^

В **Ambari** есть два типа прав доступа к кластеру: "Operator" и "Read-Only".

После создания кластера администраторы **Ambari** автоматически получают право доступа "Operator". По умолчанию другие пользователи не имеют доступа к кластеру. Права доступа к кластеру для пользователей и групп пользователей назначаются администратором в экране настроек **Ambari** (см. :numref:`Рис.%s.<admin_account_welcome-ambari>`).

Пользователям и группам пользователей с правом "Operator" предоставляется доступ к кластеру и обеспечивается полный контроль над следующими функциями кластера:

+	Запуск;
+	Остановка;
+	Перезапуск;
+	Создание нового.

Право доступа "Operator" обеспечивает полный контроль над следующими конфигурациями кластера:

+	Изменение;
+	Возврат.

Пользователям и группам пользователей с правом "Read-Only" предоставляется доступ только к просмотру кластера.

Для изменения прав доступа к кластеру для пользователей и групп пользователей администратору **Ambari** необходимо выполнить следующие действия:

+	На панели "Clusters" в экране настроек Ambari нажать кнопку *Permissions*. При этом отображается табличная форма с правами доступа "Operator" и "Read-Only" с возможностью назначения их пользователям и группам пользователей (см. :numref:`Рис.%s.<admin_cluster_permissions>`);
+	Для назначения прав необходимо в блоках "Grant permissions to these users" и "Grant permissions to these groups" указать соответствующих пользователей и группы, нажав кнопку *Add User* или *Add Group*;
+	Для снятия прав с пользователей или групп необходимо нажать значок *"X"*, расположенный рядом с именем пользователя или названием группы;
+	Для сохранения изменений нажать кнопку с пиктограммой галочки.

.. _admin_cluster_permissions:

.. figure:: ../imgs/admin_cluster_permissions.*
   :align: center

   Права доступа к кластеру


Для группы без пользователей так же возможна установка прав.

.. important:: Необходимо проверить наличие прав доступа у каждого пользователя, каждой группы и каждого пользователя в группе, чтобы убедиться, что у всех  есть соответствующие разрешения

Дополнительные сведения об управлении пользователями и группами пользователей приведены в разделе "Пользователи и группы пользователей".


Переименование кластера
^^^^^^^^^^^^^^^^^^^^^^^

Для изменения названия кластера необходимо на панели "Clusters" кликнуть по значку *Rename Cluster* (:numref:`Рис.%s.<admin_cluster_rename-cluster>`).

.. _admin_cluster_rename-cluster:

.. figure:: ../imgs/admin_cluster_rename-cluster.*
   :align: center

   Значок «Rename Cluster»

При этом название кластера становится доступным для редактирования. Необходимо вручную ввести новое название кластера, нажать галочку и подтвердить действие.

.. important:: Чтобы изменения вступили в силу, необходимо перезапустить Ambari Server и Ambari Agents

При смене названия кластера также меняется ресурс **REST API**.

.. important:: Для использования кластера с новым названием необходимо настроить все применимые API


Добавление узлов в существующий кластер ADH
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Для добавления новых узлов в существующий кластер **Arenadata Hadoop** администратору **Ambari** необходимо:

1.	В **Ambari** перейти на вкладку "Hosts" (см. :numref:`Рис.%s.<admin_account_dashboard>`) и в меню "Actions" выбрать пункт *Add New Hosts* (:numref:`Рис.%s.<admin_cluster_add-new-hosts>`).


.. _admin_cluster_add-new-hosts:

.. figure:: ../imgs/admin_cluster_add-new-hosts.*
   :align: center

   Добавление нового узла


2.	При этом запускается мастер добавления узла, в котором необходимо указать адрес нового узла, компоненты кластера, которые необходимо развернуть на новом узле, параметры этих компонентов и т.п. (:numref:`Рис.%s.<admin_cluster_add-host-wizard>`).

.. _admin_cluster_add-host-wizard:

.. figure:: ../imgs/admin_cluster_add-host-wizard.*
   :align: center

   Мастер добавления узла


Последовательность выполняемых действий и настроек в целом повторяет процесс развертывания нового кластера, за исключением некоторых пунктов.

Примечания:

+ На добавляемом узле должны быть выполнены все настройки, описанные в разделе `Подготовка к установке Hadoop <http://docs.arenadata.io/adh/install/prepare.html#hadoop>`_ документа `Инструкция по установке кластера <http://docs.arenadata.io/adh/install/index.html>`_;

+ В случае добавления узла, аналогичного по функционалу уже имеющимся в кластере (например, при добавлении дополнительного узла **HDFS DataNode**), рекомендуется использовать узлы с конфигурацией (аппаратные ресурсы, разметка дисков, параметры ОС и т.д.), аналогичной уже существующим узлам с той же ролью. В противном случае для добавлемого узла может потребоваться использование отдельной группы конфигурации **Ambari**.


Переход на главный экран Ambari
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Для возвращения на главный экран **Ambari** необходимо на панели "Clusters" нажать кнопку *Go to Dashboard* (см. :numref:`Рис.%s.<admin_account_welcome-ambari>`). При этом происходит переход на главный экран **Ambari** (см. :numref:`Рис.%s.<admin_account_dashboard>`).
